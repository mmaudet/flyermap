---
phase: 05-wizard-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - index.html
  - package.json
  - src/ui/wizard.js
autonomous: true

must_haves:
  truths:
    - "User sees welcome screen on first launch"
    - "Wizard shows progress stepper"
    - "User can navigate to next step"
  artifacts:
    - path: "index.html"
      provides: "Wizard dialog HTML structure"
      contains: '<dialog id="welcome-wizard"'
    - path: "src/ui/wizard.js"
      provides: "Wizard initialization and step handlers"
      exports: ["initWelcomeWizard"]
      min_lines: 50
  key_links:
    - from: "src/ui/wizard.js"
      to: "Wizard-JS library"
      via: "CDN import or npm package"
      pattern: "Wizard.*init"
    - from: "src/ui/wizard.js"
      to: "dialog element"
      via: "showModal() call"
      pattern: "showModal\\(\\)"
---

<objective>
Set up Wizard-JS infrastructure with welcome screen and progress stepper.

Purpose: Create the foundation for the first-launch wizard flow, establishing the dialog structure and Wizard-JS integration that subsequent steps will build upon.

Output: Wizard dialog with welcome screen (step 1) and initialized Wizard-JS instance showing progress stepper.
</objective>

<execution_context>
@/Users/mmaudet/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mmaudet/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-wizard-foundation/05-RESEARCH.md

# Prior phase context
@.planning/phases/02-team-management/02-01-SUMMARY.md

# Existing patterns
@src/ui/zoneEditor.js
@index.html
</context>

<tasks>

<task type="auto">
  <name>Install Wizard-JS and create wizard dialog HTML</name>
  <files>package.json, index.html</files>
  <action>
Install Wizard-JS library via npm:
```bash
npm install @adrii_/wizard-js@2.0.3
```

Add wizard dialog to index.html before the closing `</body>` tag, following the native dialog pattern from zoneEditor:

```html
<dialog id="welcome-wizard" class="wizard-dialog">
  <div class="wizard">
    <!-- Step 1: Welcome -->
    <div class="wz-step" data-step-name="welcome">
      <h2>Bienvenue sur FlyerMap</h2>
      <p>Configurez votre commune en quelques étapes pour commencer.</p>
      <p><strong>Étapes :</strong></p>
      <ol>
        <li>Entrez votre code postal</li>
        <li>Sélectionnez votre commune</li>
        <li>Confirmez la zone de travail</li>
      </ol>
      <button class="wz-next-button btn-primary">Commencer</button>
    </div>

    <!-- Step 2: Postal code (placeholder for next plan) -->
    <div class="wz-step" data-step-name="postal">
      <h3>Code postal</h3>
      <p>Cette étape sera implémentée dans le prochain plan.</p>
    </div>

    <!-- Step 3: Preview (placeholder for later plan) -->
    <div class="wz-step" data-step-name="preview">
      <h3>Aperçu</h3>
      <p>Cette étape sera implémentée dans un plan ultérieur.</p>
    </div>
  </div>
</dialog>
```

Add Wizard-JS CSS import to index.html in `<head>`:
```html
<link rel="stylesheet" href="/node_modules/@adrii_/wizard-js/dist/wizard.min.css">
```

Do NOT use CDN - use npm package for consistency with existing Vite build setup.
  </action>
  <verify>
Run `npm list @adrii_/wizard-js` to confirm version 2.0.3 installed.
Verify index.html contains dialog#welcome-wizard with class="wizard-dialog".
Verify Wizard-JS CSS link present in `<head>`.
  </verify>
  <done>
package.json includes @adrii_/wizard-js@2.0.3 dependency.
index.html contains welcome-wizard dialog with 3 wz-step elements.
Wizard-JS CSS linked in head.
  </done>
</task>

<task type="auto">
  <name>Create wizard.js module with Wizard-JS initialization</name>
  <files>src/ui/wizard.js</files>
  <action>
Create src/ui/wizard.js following the pattern from 05-RESEARCH.md but adapted for FlyerMap architecture.

Import Wizard-JS:
```javascript
import Wizard from '@adrii_/wizard-js';
```

Export initWelcomeWizard() function that:
1. Gets dialog element by ID: `document.getElementById('welcome-wizard')`
2. Creates Wizard instance with config:
   - `wz_class: '.wizard'`
   - `wz_nav_style: 'dots'` (progress indicator)
   - `wz_button_style: 'buttons'` (custom buttons per step)
   - `progressbar: true` (show progress bar)
3. Calls `wizard.init()`
4. Calls `dialog.showModal()` to display wizard

Setup welcome step handler:
- Select welcome step next button: `document.querySelector('[data-step-name="welcome"] .wz-next-button')`
- Add click listener that proceeds to next step (Wizard-JS handles navigation automatically)

Use let variable at module scope for wizard instance (not const - may need to recreate):
```javascript
let wizard = null;
```

Store wizard instance in module-scoped variable so it can be accessed by future step handlers.

Do NOT implement sessionStorage persistence yet (deferred to Plan 2).
Do NOT implement postal code logic (that's Plan 2).
  </action>
  <verify>
Check src/ui/wizard.js exists and exports initWelcomeWizard.
Verify import statement for Wizard-JS present.
Verify wizard.init() and dialog.showModal() calls present.
Run `grep "wz_nav_style" src/ui/wizard.js` - should return match.
  </verify>
  <done>
src/ui/wizard.js file created with ~60-80 lines.
Exports initWelcomeWizard() function.
Wizard instance initialized with dots navigation and progress bar.
Dialog displays on function call.
  </done>
</task>

</tasks>

<verification>
Run `npm run dev` and open browser.
Manually call `initWelcomeWizard()` from browser console.
Verify:
1. Dialog appears as modal overlay
2. Welcome screen visible with "Commencer" button
3. Progress stepper (dots) visible showing step 1 of 3
4. Clicking "Commencer" advances to step 2 (placeholder screen)
5. Progress indicator updates to show step 2 active
</verification>

<success_criteria>
- Wizard-JS 2.0.3 installed in package.json
- Dialog element with welcome-wizard ID exists in index.html
- Wizard-JS CSS imported in head
- src/ui/wizard.js exports initWelcomeWizard function
- Calling initWelcomeWizard() displays modal wizard with working step navigation
- Progress stepper shows 3 steps with first step active on open
</success_criteria>

<output>
After completion, create `.planning/phases/05-wizard-foundation/05-01-SUMMARY.md`
</output>
